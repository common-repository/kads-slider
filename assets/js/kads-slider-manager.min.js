
(function(b){var a={};b.kadsManager={init:function(){var c={id:"",ajax:"",url:"",current:0,action:"add",boxSelected:null};this.sever=b.extend(true,{},c,kadsOptions);this.vendors="Khtml Ms O Moz Webkit".split(" ");this.div=document.createElement("div");a=this;this.css3Loaded={};this.scriptLoaded={};this.lidx=0;this.current=0;this.listLayer={};this.layerSelected=null;this.layerPreviewCurrent=null;this.ivtimer=null;this.ivtyping=500;this.gSize=10;this.handles="n, e, s, w, ne, se, sw, nw ";this.viplay=0;this.frame=[];this.isReset=0;this.key="";this.isCreate=1;this.isEdit=0;this.maxTimeRun=0;this.refixpx=3;this.currentData={};this.item=this.idefault();this.c=b(".kads-slider-page-admin");this.cl=b(".box-list-items");if(this.c.length){this.p=b(".slider-preview-warper",this.c);this.g=b(".slider-add-warper",this.c);this.gImage=b(".box-gird-image",this.g);this.tl=b(".kads-slider-timeline-cont",this.g);this.ltl=b(".kads-slider-ul-list-row",this.tl);this.ltlOverPlay=b(".kads-slider-overplay-wrap",this.tl);this.ll=b(".kads-slider-child-layer-list",this.tl);this.pm=b(".add-actions-popup",this.g);this.pmBg=b(".add-actions-popup-bg",this.g);this.pmbutton=b(".button-actions-popup",this.g);this.pl=b(".label",this.pm);this.pb=b(".button",this.pm);this.im=b(".input-main",this.g);this.ithumb=b("#main-thumb",this.g);this.clabel=null;this.ctline=null;this.ltpl=b(".html-layer-template",this.g).html();this.iaddtpl=b(".html-add-item-template",this.g).html();this.htmlltllabel=b(".html-layer-timeline-label",this.g).html();this.htmlltl=b(".html-layer-timeline",this.g).html();this.controls={};this.styles={};this.cssfix=this.getCssFix("transition");this.iscss3=this.checkCss();this.el=null;this.optionsanimate={};this.animations={bounce:" Top Left Right Bottom BottomLeft BottomRight TopLeft TopRight".split(" "),zoom:" Top Left Right Bottom BottomLeft BottomRight TopLeft TopRight".split(" "),fade:" Top Left Right Bottom BottomLeft BottomRight TopLeft TopRight".split(" "),flip:" X Y TopFront TopBack BottomFront BottomBack LeftFront LeftBack RightFront RightBack".split(" "),rotate:" TopLeft TopRight BottomLeft BottomRight".split(" "),slide:" Top Left Right Bottom".split(" ")};this.loadEvents();this.isFullHeight=b("#kads-yesno-control-sliderfullheight",this.c).is(":checked");if(this.isFullHeight){b(".box-gird",a.c).height("800px")}this.isOverplay=b("#kads-yesno-control-slideroverplay",this.c).is(":checked");if(this.isOverplay){this.addOverplay()}}else{if(this.cl.length){this.loadEventsLists()}}},isu:function(c){return(typeof c==="undefined"||!c)},logs:function(){if(this.isu(console.log)){for(var c in arguments){console.log(arguments[c])}}},loadEventsLists:function(){var c=this.sever.ajax;b(".kads-slider-loading").fadeOut();b(".bt-remove",this.cl).on("click",function(f){f.preventDefault();var i=b(this).closest(".box-item");var h=b(this).attr("data-id");var g=b(this).attr("data-title");var e={action:"kads_slider_ajax_remove",id:h};var d=confirm("Do you really want to delete: "+g+" ?");if(d){b(".kads-slider-loading").fadeIn();b.ajax({url:c,type:"POST",data:e,dataType:"json",success:function(j){if(j&&j.success){i.remove()}b(".kads-slider-loading").fadeOut()}})}})},loadEvents:function(){b(".yesno .button",this.c).on("click",function(g){g.preventDefault();var f=b(this).closest(".yesno");if(f.hasClass("selected")){return}b(f).find("input").prop("checked",true);var e=f.closest(".kads-slider-control-yesno");b(".yesno",e).removeClass("selected");f.addClass("selected")});b('<button class="button quantity-button quantity-up">+</button><button class="button quantity-button quantity-down">-</button>').insertAfter(".kads-slider-control-number .quantity input",this.c);b(".quantity .quantity-up",this.c).click(function(){var i=b(this).closest(".quantity"),f=i.find("input"),e=parseInt(f.attr("max")),h=0;var g=parseFloat(b(f).val());if(isNaN(g)){g=0}if(g>=e){h=g}else{h=g+1}i.find("input").val(h);i.find("input").trigger("change");return false});b(".quantity .quantity-down",this.c).click(function(){var i=b(this).closest(".quantity"),e=i.find("input"),h=parseInt(e.attr("min")),g=0;var f=parseFloat(b(e).val());if(isNaN(f)){f=0}if(f<=h){g=f}else{g=f-1}i.find("input").val(g);i.find("input").trigger("change");return false});var d=function(){clearTimeout(a.ivtimer);a.el=this;if(b(this).hasClass("input-main-change")){a.ivtimer=setTimeout(a.fnsmc(),a.ivtyping)}else{a.ivtimer=setTimeout(a.fnsc(),a.ivtyping)}};var c=function(f){if(f.target.className!=="add-layer"){if(b(".add-layer ul").is(":visible")){b(".add-layer ul").fadeOut()}window.removeEventListener("click",c)}};b(".add-layer",this.g).click(function(){b(".add-layer ul").fadeToggle();window.addEventListener("click",c)});b(".color-picker-hex",this.c).wpColorPicker({change:function(e,f){b(this).kadsSliderChangeVal(f.color.toCSS())}});b(".wp-picker-default",this.c).after('<input class="button button-small wp-picker-remove" value="Remove" type="button">');b(".wp-picker-remove",this.c).click(function(){var f=b(this).closest(".wp-picker-container");b(".wp-color-result",f).css("background-color","#ffffff");var e=b(".wp-color-picker",f);b(e).kadsSliderChangeVal("");if(b(e).hasClass("input-main-change")){a.gImage.css("background-color","")}});if(b.isFunction(b.fn.SumoSelect)){b(".select-style",this.g).SumoSelect()}else{this.loadScript("sumoselect/jquery.sumoselect.min.js",function(){b(".select-style",this.g).SumoSelect()})}this.g.on("mousedown","div.box-layer",function(){var e=b(this).attr("current");a.selectedbox(e)});this.g.on("mouseup","div.box-layer",function(){a.setoplayer(this)});this.g.on("click",".responsive-design .button",function(f){a.el=this;a.rpdesign();f.preventDefault()});this.loadfnanimate("in",b("#html-animation-in",this.g));this.loadfnanimate("out",b("#html-animation-out",this.g));this.g.on("change",".select-style",function(){var e=b(this);a.el=e;switch(e.attr("data-key")){case"animateIn":a.loadfnanimate("in",e);break;case"animateOut":a.loadfnanimate("out",e);break;default:break}a.fnselect()});this.g.on("click",".add-actions-popup .popup-inner .close",function(){a.cancelSliderPopup()});this.g.on("change keyup keydown","input.input-change",d);this.g.on("change","input.input-change",d);this.c.on("click",".manage-events",function(g){var f=b(this).attr("actions");a.kadsEvents(f,this);g.preventDefault()});this["add-video-layer"]=function(e){this.el=e;this.addLayer();this.showSliderPopup()};this["slider-preview"]=function(e){this.fnmPreview()};this["add-image-layer"]=function(e){this.el=e;this.addLayer();this.showSliderPopup("Images: ")};this["add-html-layer"]=function(e){this.el=e;this.addLayer()};this["add-button-layer"]=function(e){this.el=e;this.addLayer();this.setButtonLayer()};this["button-popup-action"]=function(e){this.el=e;switch(b(e).attr("data-action")){case"save":a.saveEditButton();break;case"cancel":a.hidePopupButton();break;default:break}};this["add-overplay"]=function(e){this.el=e;this.addOverplay()};this["layer-overplay-remove"]=function(e){this.el=e;this.removeOverplay()};this["upload-button"]=function(e){this.el=e;this.openFrame()};this["add-style-position"]=function(e){this.el=e;this.fnposition()};this["close-image"]=function(e){this.el=e;this.g.fadeOut()};this["add-style-key"]=function(e){this.el=e;this.fnkey()};this["preview-close"]=function(e){this.el=e;this.p.fadeOut()};this["preview-all-close"]=function(e){b(".slider-preview-all-warper").fadeOut();b("#slider-preview-all-warper").html("")};this["save-image"]=function(e){this.el=e;this.saveSettings()};this["add-image"]=function(e){this.el=e;this.resetAll();this.g.css("top",b(e).offset().top-300);this.isEdit=0;this.key="";this.g.fadeIn();this.scrollEvents()};this["edit-image"]=function(e){this.resetAll();this.lidx=0;this.isEdit=1;this.key="";this.loadData(e);this.g.css("top",b(e).offset().top-300);this.g.fadeIn();this.scrollEvents()};this["copy-image"]=function(e){this.resetAll();this.lidx=0;this.isEdit=1;this.key="";var g=b(e).closest(".box-item");this.sever.id=parseInt(this.sever.id)+1;var f=g.clone(true).attr("data-id",this.sever.id).attr("id","box-images-"+this.sever.id);f.insertAfter(g)};this["remove-image"]=function(e){var f=confirm("Do you really want to delete this picture?");if(f===true){b(e).closest(".box-item").remove()}};this["preview-image"]=function(e){this.el=e;this.p.fadeIn();this.loadPreview()};this["layer-edit"]=function(f){if(a.currentData.type==="button"){a.showEditButton()}else{var e=b(f).closest(".warper-edit"),g=b(f).closest(".box-layer");b(g).css({"min-height":"60px"});b(e).addClass("edit-active");b(".actions-group",e).addClass("active")}};this["layer-delete"]=function(f){var e=b("#box-"+b(f).attr("current"),this.g);this.deleteLayer(e)};this["layer-save"]=function(f){var e=b(f).closest(".warper-edit"),g=b(f).closest(".box-layer");b(".content-edit",g).html(b(".content-edit-textarea textarea",g).val());b(g).css({"min-height":""});this.setoplayer(g);b(e).removeClass("edit-active");b(".actions-group",e).removeClass("active")};this["layer-cancel"]=function(f){var e=b(f).closest(".warper-edit"),g=b(f).closest(".box-layer");b(g).css({"min-height":""});b(e).removeClass("edit-active");b(".actions-group",e).removeClass("active");this.setoplayer(g)};this["layer-copy"]=function(e){this.el=e;this.copyLayer(b(e).attr("current"))};this.playing=false;this.lptime=0;this["layer-play"]=function(){this.playLayer()};this["layer-pause"]=function(){this.pauseLayer()};b(".controls-data",this.g).each(function(){a.updateControls(b(this))});this.styles={isPreview:false,k:"",tags:function(f,e){f.attr(this.k,e)},desktop:function(f,e){f.attr(this.k,e)},laptop:function(f,e){f.attr(this.k,e)},tablet:function(f,e){f.attr(this.k,e)},smartphone:function(f,e){f.attr(this.k,e)},animate:function(f,e){f.attr(this.k,e);f.addClass(e)},"class":function(f,e){f.attr(this.k,e);f.addClass(e)},html:function(f,e){if(!this.isPreview){b(".content-edit",f).html(e);b("textarea",f).val(e)}else{b(".content-inner",f).html(e)}},type:function(f,e){f.attr(this.k,e)},link:function(f,e){f.attr(this.k,e)},wait:function(f,e){f.attr(this.k,e)},speed:function(f,e){f.attr(this.k,e)},animateIn:function(f,e){f.attr(this.k,e)},animateInState:function(f,e){f.attr(this.k,e)},animateOut:function(f,e){f.attr(this.k,e)},animateOutState:function(f,e){f.attr(this.k,e)},setval:function(h,f,e,g){this.k=f;if(this[f]){this[f].call(this,h,e)}else{a.setLayerCss(f,e)}}}},playLayer:function(){if(this.playing){return}this.playAnimation.start();this.loadcss("animate.css");this.playing=true;var g=0;var f=this.maxTimeRun+600;var d=f-300;var c=document.getElementById("kads-slider-frames-times");var e=document.getElementById("kads-slider-timeline-delayindicator");this.diLayer=function(){};this.lptime=setInterval(function(){setTimeout(function(){var h=(g+20)+"px";c.style.left=h;e.style.left=h;c.innerHTML=(g*10);g+=1;switch(g){case 1:a.playAnimation.animateIn();break;case d:a.playAnimation.animateOut();break;case f:g=0;break;default:break}},100)},10)},pauseLayer:function(){this.playing=false;clearInterval(this.lptime);this.playAnimation.stop();this.diLayer=this.diDefaults},playState:{aIn:"",aOut:"",setData:function(d){var e=a.ldefault();var c=b.extend(true,{},e,d);this.aIn=c.animateIn+"In";if(!a.isu(c.animateInState)){this.aIn+=c.animateInState}this.aOut=c.animateOut+"Out";if(!a.isu(c.animateOutState)){this.aOut+=c.animateOutState}}},playAnimation:{animateShow:true,layers:{},start:function(){var c=this;b.each(a.listLayer,function(d,e){if(a.item.layers[d]){var g=a.item.layers[d];a.playState.setData(g);var f={};f._class=b(e).attr("class")+" ";f._style=b(e).attr("style");f._in=a.playState.aIn+" animated";f._out=a.playState.aOut+" animated";f._delay=(g.wait*10)+"ms";f._speed=((g.speed-300)/10)+"ms";f._layer=e;f._animateIn=function(){b(this._layer).css(a.getCss("animation-duration"),this._speed);b(this._layer).css(a.getCss("animation-delay"),this._delay);b(this._layer).removeClassExcept(this._class+this._in)};f._animateOut=function(){b(this._layer).css(a.getCss("animation-delay"),"");b(this._layer).removeClassExcept(this._class+this._out)};f._reset=function(){b(this._layer).css(a.getCss("animation-duration"),"");b(this._layer).css(a.getCss("animation-delay"),"");b(this._layer).removeClassExcept(this._class.trim())};c.layers[d]=f;b(e).css(a.getCss("animation-delay"),"");b(e).removeClassExcept(f._class+f._out)}})},stop:function(){b.each(this.layers,function(){this._reset()})},animateIn:function(){this.animateShow=false;b.each(this.layers,function(){this._animateIn()})},animateOut:function(){this.animateShow=true;b.each(this.layers,function(){this._animateOut()})}},getCssFix:function(d){if(d in this.div.style){return""}d=d.replace(/^[a-z]/,function(e){return e.toBottomperCase()});var c=this.vendors.length;while(c--){if(this.vendors[c]+d in this.div.style){switch(this.vendors[c]){case"Khtml":return"-khtml-";case"Ms":return"-ms-";case"O":return"-o-";case"Moz":return"-moz-";case"Webkit":return"-webkit-";default:return""}}}return""},getCss:function(c){return this.cssfix+c},checkCss:function(){var d="transition";if(d in this.div.style){return true}d=d.replace(/^[a-z]/,function(e){return e.toBottomperCase()});var c=this.vendors.length;while(c--){if(this.vendors[c]+d in this.div.style){return true}}return false},loadfnanimate:function(d,f){var c=f.val();var h=b(".item-row.html-animation-"+d+"",this.g);var g=b("#html-animation-"+d+"-state",h);h.hide();g.html("");var i=this.animations[c];if(i){var e="";if(this.isu(this.optionsanimate[c])){b.each(i,function(){e+='<option value="'+this+'">'+this.replace(/([A-Z])/g," $1").trim()+"</option>"});g.html(e);this.optionsanimate[c]=e}else{e=this.optionsanimate[c];g.html(e)}}g[0].sumo.reload();setTimeout(function(){g.trigger("change")},200);h.show()},updateControls:function(c){var d={};d.key=c.attr("data-key");d.tags=c.attr("data-actions");d.el=c;switch(d.tags){case"color":d.val=function(e){this.el.wpColorPicker("color",e)};break;case"text":d.val=function(e){this.el.val(e)};break;case"select":d.val=function(e){this.el[0].sumo.selectItem(e)};break;case"button":d.val=function(e){var g=b(".responsive-design.no",this.el);var f=b(".responsive-design.yes",this.el);if(e===""){g.find("input").prop("checked",false);f.find("input").prop("checked",true);g.removeClass("selected");f.addClass("selected");return}else{f.find("input").prop("checked",false);g.find("input").prop("checked",true);g.addClass("selected");f.removeClass("selected")}};break;default:d.val=function(){};break}this.controls[d.key]=d},setctrlval:function(d,c){if(this.isu(d)||this.isu(c)){c="";b.each(this.controls,function(){var f=this;if(f.tags){f.val(c)}});return}if(this.controls[d]){var e=this.controls[d];if(e.tags){e.val(c)}}},htmlAddItem:function(e){this.sever.id=parseInt(this.sever.id)+1;var d=this.sever.id;var c=this.format(this.iaddtpl,d);b(".box-item.box-item-add",this.c).before(c);this.sever.boxSelected=b("#box-images-"+d,this.c);this.htmlEditItem(e)},format:function(d){var c=Array.prototype.slice.call(arguments,1);return d.replace(/{(\d+)}/g,function(e,f){return typeof c[f]!=="undefined"?c[f]:e})},kadsEvents:function(d,c){if(!this[d]){this.logs(d+" => This is not a function");return}return this[d].call(this,c)},setoplayer:function(c){b(c).each(function(){a.addLayerData("top",this.offsetTop);a.addLayerData("left",this.offsetLeft);a.addLayerData("width",this.offsetWidth);a.addLayerData("height",this.offsetHeight);a.addLayerData("html",b(".content-edit",c).html())})},setButtonLayer:function(){var c={type:"button",layout:"",link:"",html:"Simple Button"};b(".content-edit",this.layerSelected).html(c.html);this.setValueLayer(c);b(this.layerSelected,this.g).addClass("kads-m-button");b(this.layerSelected,this.g).css("height","138px");b(this.layerSelected,this.g).css("height","33.4px")},showSliderPopup:function(c){if(!this.isu(c)){this.pl.html(c);this.pb.attr("data-type","image")}this.pm.css("top",this.g.offset().top);this.pmBg.fadeIn();this.pm.fadeIn()},hideSliderPopup:function(){this.pm.fadeOut();this.pmBg.fadeOut()},saveEditButton:function(){var c=b("#button-form-popup",this.pmbutton);var d=c.serializeArray();b.each(d,function(){a.addLayerData(this.name,this.value)});var e=this.currentData;if(typeof e.layout!=="undefined"&&e.layout!==""){b(this.layerSelected,this.g).addClass(e.layout)}this.hidePopupButton();c.trigger("reset")},showEditButton:function(){var c=this.currentData;if(typeof c.link!=="undefined"){b(".input-link",this.pmbutton).val(c.link)}if(typeof c.html!=="undefined"){b(".input-html",this.pmbutton).val(c.html)}if(typeof c.layout!=="undefined"){if(c.layout===""){b(".bt-style-none",this.pmbutton).prop("checked",true)}else{b(".bt-style-"+c.layout,this.pmbutton).prop("checked",true)}}a.showPopupButton()},showPopupButton:function(){this.pmbutton.css("top",this.g.offset().top);this.pmBg.fadeIn();this.pmbutton.fadeIn()},hidePopupButton:function(){this.pmbutton.fadeOut();this.pmBg.fadeOut()},cancelSliderPopup:function(){this.pm.fadeOut();this.pmBg.fadeOut();b(".hd-delete-html",this.layerSelected).trigger("click")},htmlpl:function(d,c){return'<div id="box-'+d+'" current="'+d+'" class="box-layer"><div class="content-inner">'+c+"</div></div>"},saveSettings:function(){var d=JSON.stringify(this.item);var c=encodeURI(d);if(this.isEdit){this.htmlEditItem(c)}else{this.htmlAddItem(c)}this.g.fadeOut()},htmlEditItem:function(d){if(!this.sever.boxSelected){return}var c={type:"html"};b(".box-layer-list",this.sever.boxSelected).html("");b.each(this.item.layers,function(){var f=b.extend(true,{},c,this);var e="";switch(f.type){case"html":e+='<span class="layer">';e+=f.html;e+="</span>";break;case"image":e+='<span class="layer">';e+='<span class="dashicons dashicons-format-image"></span>';e+="</span>";break;case"button":e+='<span class="layer">';e+='<span class="dashicons dashicons-share"></span>';e+="</span>";break;default:e+='<span class="layer">';e+='<span class="dashicons dashicons-format-video"></span>';e+="</span>";break}b(".box-layer-list",a.sever.boxSelected).append(e)});if(this.item.link){b(".bg",this.sever.boxSelected).css("background-image","url("+this.item.link+")")}b(".bg",this.sever.boxSelected).css("background-color",this.item.color);b(".item",this.sever.boxSelected).val(d)},loadPreview:function(){var d=b(this.el).closest(".box-item");var f=decodeURI(b(".item",d).val());var e=JSON.parse(f);this.viplay=1;if(e){b(".box-layer",this.p).remove();var g={type:"html",link:""};b.each(e.layers,function(h,l){var j=b.extend(true,{},g,l);var i=a.addPreviewLayer(j);a.layerPreviewCurrent=i;switch(j.type){case"html":case"image":case"button":break;default:a.setelmedia(j.link,j.type,"layer-preview");break}});var c=b(".bg",this.p);c.html("");this.setelmedia(e.link,e.type,"main-preview");this.setelmedia(e.thumb,"image","thumb-preview");if(e.color){c.css("background-color",e.color)}}this.viplay=0},addPreviewLayer:function(d){b(".box-gird-preview",this.p).append(this.htmlpl(this.lidx,"Future collections"));var c=b("#box-"+this.lidx,this.p);this.styles.isPreview=true;b.each(d,function(e,f){a.styles.setval(c,e,f)});this.styles.isPreview=false;this.lidx=this.lidx+1;return c},idefault:function(){return{link:"",color:"",html:"",animate:"",thumb:"",type:"image",layers:{}}},ldefault:function(){return{el:0,type:"html",link:"",wait:0,speed:3300,animateIn:"fade",animateOut:"fade"}},loadData:function(d){var c=b(d).closest(".box-item");var i=b(c).data("id");var g=decodeURI(b(".item",c).val());var f=JSON.parse(g);this.sever.boxSelected=c;if(f){this.listLayer={};this.currentData={};this.item=this.idefault();b(".box-layer").remove();this.key=i;this.isCreate=0;var e=0;var h=this.ldefault();b.each(f.layers,function(j,m){var l=b.extend(true,{},h,m);a.addLayer();b.each(l,function(n,k){switch(n){case"class":break;case"top":if(a.isFullHeight){a.styles.setval(a.layerSelected,n,k)}else{if(k>500){k=400}a.styles.setval(a.layerSelected,n,k)}break;default:a.styles.setval(a.layerSelected,n,k);break}});switch(l.type){case"html":case"image":break;case"button":break;default:a.setelmedia(l.link,l.type,"layer");break}if(l.type==="button"){b(a.layerSelected,a.c).addClass("kads-m-button")}a.currentData=l;a.setDataLayer(e,a.currentData);a.fnlayertldata(l);e=e+1});this.gImage.html("");this.item.link=f.link;this.item.color=f.color;this.item.type=f.type;this.isCreate=1;this.setelmedia(f.link,f.type,"main");this.setelmedia(f.thumb,"image","thumb");if(f.color){this.gImage.css("background-color",f.color)}setTimeout(function(){b.each(a.currentData,function(l,j){a.setctrlval(l,j)})},100)}},addLayer:function(){this.resetValue();b(".box-gird",this.g).append(this.format(this.ltpl,this.lidx,"Future collections"));this.ll.append(this.format(this.htmlltllabel,this.lidx));this.ltl.append(this.format(this.htmlltl,this.lidx));var d=this.ldefault();this.currentData=d;this.setDataLayer(this.lidx,d);this.selectedbox(this.lidx);this.fnlayertldata(d);this.tlEvents();this.actionsLayer();var c=this.layerSelected;this.setListLayer(this.lidx,c);if(this.isCreate){a.setoplayer(c);a.addLayerData("type","html")}setTimeout(function(){b("#html-animation-out",a.g).trigger("change")},10);setTimeout(function(){b("#html-animation-in",a.g).trigger("change")},20);this.lidx=this.lidx+1},addOverplay:function(){this.resetValue();b(".box-gird",this.g).append('<div class="kads-box-overplay">');this.ltlOverPlay.fadeIn();this.item.overplay=true},removeOverplay:function(){this.resetValue();b(".box-gird .kads-box-overplay",this.g).append('<div class="kads-box-overplay">').remove();this.ltlOverPlay.fadeOut();this.item.overplay=false},actionsLayer:function(){var c=this.layerSelected;c.draggable({containment:"parent",drag:function(f,g){var e=b(this).draggable("option","snapTolerance");var d=g.position.top%a.gSize;var h=g.position.left%a.gSize;if(d<=e){g.position.top=g.position.top-d}if(h<=e){g.position.left=g.position.left-h}},stop:function(){a.setoplayer(this)}});c.resizable({handles:this.handles,maxHeight:800,stop:function(d,e){a.setoplayer(this);b(this).trigger("dragstop")}})},deleteLayer:function(d){var c=d.attr("current");d.remove();b("#timelinelable-"+c,this.ll).remove();b("#timeline-"+c,this.ltl).remove();this.removelist(c);this.setLastAsCurrent()},removelist:function(c){this.setListLayer(c);this.setDataLayer(c)},setLastAsCurrent:function(){var d=this.getLastLayer();if(d){var c=b(d).attr("current");this.selectedbox(c)}},getLastLayer:function(){var c;b.each(this.listLayer,function(){c=this});return c},resetAll:function(){this.resetValue();this.im.val("");this.ithumb.val("");b(".box-layer",this.g).remove();this.gImage.html("");b(".box-gird-bg",this.g).removeClass("size-20").removeClass("size-10");this.gImage.css("background-color","");this.gImage.css("background-image","");b.each(this.listLayer,function(c){b(c).remove()});this.listLayer={};this.currentData={};this.item=this.idefault();b(this.ltl).html("");b(this.ll).html("")},resetValue:function(){this.isReset=1;this.setctrlval("");this.isReset=0},checkac:function(){if(this.isReset){return 1}return 0},rpdesign:function(){if(this.checkac()){return}var f=b(this.el);var g=f.closest(".responsive-design");if(g.hasClass("selected")){return}b(g).find("input").prop("checked",true);var c=g.closest(".hd-control-yesno");b(".selection .responsive-design",c).removeClass("selected");g.addClass("selected");var e=g.data("key");var d=g.data("value");if(d==="0"){b(this.layerSelected,this.g).attr(e,1);this.addLayerData(e,1)}else{b(this.layerSelected,this.g).removeAttr(e);this.addLayerData(e)}},fnselect:function(){if(this.checkac()){return}var e=b(this.el);var d=e.data("key");var c=e.val();switch(d){case"tags":if(!this.layerSelected){return}b(this.layerSelected,this.g).attr("tags",c);this.addLayerData("tags",c);var f=b(".content-edit",this.layerSelected).html();b(".content-edit",this.layerSelected).replaceWith(b("<"+c+' class="content-edit">'+f+"</"+c+">"));break;case"mainanimate":this.item.animate=c;break;case"gird":b(".box-gird-bg",this.g).removeClass("size-20").removeClass("size-10");b(".box-gird-bg",this.g).addClass("size-"+c);break;default:if(!this.layerSelected){return}if((c===null||c.isEmpty())){b(this.layerSelected,this.g).removeAttr(d);this.addLayerData(d)}else{b(this.layerSelected,this.g).attr(d,c);this.addLayerData(d,c)}break}},fnposition:function(){if(this.checkac()){return}var e=b(this.el);var c=e.data("key");var f=0;var d=b(".box-gird",this.g).outerWidth();switch(c){case"center":f=(d/2)-(b(this.layerSelected,this.g).width()/2);break;case"right":f=d-b(this.layerSelected,this.g).width();break;default:f=0;break}if(this.layerSelected){this.setLayerCss("left",f);this.setoplayer(this.layerSelected)}},fnsc:function(){if(this.checkac()){return}var f=b(this.el);var e=f.data("key"),d=f.val(),c=f.data("att");if(c==="class"){if(e&&this.layerSelected){b(this.layerSelected,this.g).addClass(d);b(this.layerSelected,this.g).attr("custom-class",d);this.addLayerData("class",d)}}else{if(e&&this.layerSelected){this.setLayerCss(e,d);this.addLayerData(e,d)}}},fnsmc:function(){if(this.checkac()){return}var e=b(this.el);var d=e.data("key"),c=e.val();if(d&&c){switch(d){case"main-images":this.setelmedia(c,"","main");break;case"color":this.gImage.css("background-color",c);this.item[d]=c;break;case"thumb":this.setelmedia(c,"","thumb");break;default:break}}},isButtonAceptKey:function(c){var d=false;if(this.currentData.type==="button"){switch(c){case"width":case"height":case"color":case"font-weight":case"font-style":case"text-decoration":case"background-color":d=true;break;default:break}}return d},setLayerCss:function(d,c){b(this.layerSelected,this.g).css(d,c)},fnkey:function(){if(this.checkac()){return}var e=b(this.el);var d=e.data("key");var c=e.data("value");if(d&&this.layerSelected){this.setLayerCss(d,c);this.addLayerData(d,c)}},addLayerData:function(d,c){if(this.checkac()){return}if(this.isu(c)){delete this.currentData[d];this.saveCurrent();return}if(this.isu(this.currentData)){this.currentData=this.ldefault()}this.currentData[d]=c;this.saveCurrent()},saveCurrent:function(){this.setDataLayer(this.current,this.currentData)},setDataLayer:function(e,d){var c=this.getLayerKey(e);if(this.isu(d)){delete this.item.layers[c];return}this.item.layers[c]=d},getLayerKey:function(d){var c="layer_"+d;return c},getDataLayer:function(d){var c=this.getLayerKey(d);if(this.item.layers[c]){return this.item.layers[c]}return false},setListLayer:function(e,d){var c=this.getLayerKey(e);if(this.isu(d)){delete this.listLayer[c];return}this.listLayer[c]=d},getListLayer:function(d){var c=this.getLayerKey(d);if(this.listLayer[c]){return this.listLayer[c]}return false},pausePlayer:function(){this.player&&this.player.pause()},cleanupPlayer:function(){this.player&&wp.media.mixin.removePlayer(this.player)},openFrame:function(d){var c=b(this.el);this.mediaAction=c.data("action");this.type=c.data("type");if(!this.type){this.type="image"}if(!this.frame[this.type]){this.initFrame(this.type)}this.frame[this.type].open()},initFrame:function(){this.frame[this.type]=wp.media({button:{text:"Select"},states:[new wp.media.controller.Library({title:"Choose image or Videos",library:wp.media.query({type:this.type}),multiple:false,date:false})]});this.frame[this.type].on("select",function(){a.select()})},select:function(){var c=this.frame[this.type].state().get("selection").first().toJSON();this.setelmedia(c.url,c.mime,this.mediaAction)},setValueLayer:function(c){b(".content-edit",this.layerSelected).html(c.html);b("textarea",this.layerSelected).val(c.html);this.addLayerData("html",c.html);this.addLayerData("type",c.type);this.addLayerData("link",c.link);this.setLayerCss("height","auto");b(this.layerSelected,this.g).trigger("dragstop")},setelmedia:function(c,h,e){if(this.checkac()){return}var d=null;var g={type:"",link:"",html:""};var j=h.split("/")[0];if(this.isu(j)){h=this.getMime(c);switch(h){case"image":g.type="image";g.link=c;g.html='<img src="'+c+'">';break;case"audio/mpeg":case"audio/wav":case"video/mp4":case"video/webm":case"video/ogg":g.type=h;g.link=c;g.html='<video width="100%" height="100%" style="max-width:100%;" preload="none"><source src="'+c+'" type="'+h+'"></video>';break;default:g=this.setUrlVideo(g,c,h);break}}else{if(j==="image"){g.type="image";g.link=c;g.html='<img src="'+c+'">'}else{g.type=h;g.link=c;g.html='<video width="100%" height="100%" style="max-width:100%;" preload="none"><source src="'+c+'" type="'+h+'"></video>'}}switch(e){case"main":d=this.gImage;if(g.type==="image"){g.html="";d.css("background-image","url("+c+")")}d.html(g.html);this.item.link=g.link;this.item.type=g.type;this.item.html=g.html;this.im.val(g.link);break;case"main-preview":d=b(".bg",this.p);d.css("background-image","");if(g.type==="image"){g.html="";d.css("background-image","url("+c+")")}d.html(g.html);break;case"thumb":g.type="";g.html="";this.item.thumb=g.link;this.ithumb.val(g.link);break;case"thumb-preview":d=b(".thumbs",this.p);g.type="";g.html="";if(d){d.css("background-image","url("+c+")")}break;case"layer":d=b(".content-edit",this.layerSelected);d.html(g.html);this.setValueLayer(g);this.hideSliderPopup();break;case"layer-preview":d=b(".content-inner",this.layerPreviewCurrent);d.html(g.html);break;default:return}var i={loop:false,alwaysShowControls:false,startVolume:0,features:[]};if(d&&g.type!==""&&g.type!=="image"){var f=d.find("audio, video").get(0);this.player=new MediaElementPlayer(f,i);this.player.play();if(!this.viplay){this.pausePlayer()}}},setUrlVideo:function(f,c,h){var i=[{regex:/youtu\.be\/([\w\-.]+)/,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:true},{regex:/youtube\.com(.+)v=([^&]+)/,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$2",allowFullscreen:true},{regex:/youtube.com\/embed\/([a-z0-9\-_]+(?:\?.+)?)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:true},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc",allowfullscreen:true},{regex:/vimeo\.com\/(.*)\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$2?title=0&amp;byline=0",allowfullscreen:true},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'//maps.google.com/maps/ms?msid=$2&output=embed"',allowFullscreen:false},{regex:/dailymotion\.com\/video\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:true}];var e="",g={};switch(h){case"application/x-shockwave-flash":e='<object data="'+c+'" width="100%" type="application/x-shockwave-flash">';e+="</object>";f.type="flash";f.link=g.url;break;default:b.each(i,function(){var j,k,l;if((j=this.regex.exec(this.url))){l=this.url;for(k=0;j[k];k++){l=this.url.replace("$"+k,function(){return j[k]})}g.url=l;g.type=this.type;g.allowFullscreen=this.allowFullscreen;g.width=this.w;g.height=this.h}});var d=g.allowFullscreen?' allowFullscreen="1"':"";e='<iframe src="'+g.url+'" width="'+g.width+'" height="'+g.height+'"'+d+"></iframe>";f.type="iframe";f.link=g.url;break}f.html=e;return f},getMime:function(c){c=c.toLowerCase();c=c.substr(1+c.lastIndexOf("/"));c=c.split("?")[0];c=c.split("#")[0];c=c.split(".").pop();switch(c){case"mp3":return"audio/mpeg";case"wav":return"audio/wav";case"mp4":return"video/mp4";case"webm":return"video/webm";case"ogg":return"video/ogg";case"swf":return"application/x-shockwave-flash";case"jpg":case"gif":case"bmp":case"png":case"jpeg":return"image";default:return""}},diDefaults:function(g,i,k){var h=b(".kads-slider-frames-rows",g);var d=h[0].offsetLeft*-1;var c=i.pageX-k+d;this.framestimes.css("left",c);var j=Math.round(c-20);if(j>=0){this.timesScorll=j*10;this.framestimes.html(this.timesScorll);this.delayindicator.css("left",c)}},diLayer:function(){},scrollEvents:function(){this.timesScorll=0;this.scrollframes=b(".kads-slider-layer-frames",this.g);this.scroll=b(".kads-slider-frames-rows",this.scrollframes);this.scrolldiffX=0;this.scrollMW=0;this.scrollMoving=function(d){};this.scrollMW=parseInt(this.scroll.width());this.scrollw=this.scrollframes[0].offsetWidth;this.delayindicator=b(".kads-slider-timeline-delayindicator",this.scrollframes);this.framestimes=b(".kads-slider-frames-times",this.scrollframes);this.diLayer=this.diDefaults;this.scrollSkip=(this.scrollMW-this.scrollw)/this.scrollw;a.scrollMove=function(d){var e=d*a.scrollSkip*-1,g=a.scrollMW-(d*a.scrollSkip),f=a.scrollw-d+2;if(f>=a.scrollSkip){b(a.scroll).css("left",d)}if(g>=a.scrollw){a.scroll.css("left",e)}};b(".kads-slider-scroll-timeline",this.scrollframes).css("width",(this.scrollw/this.scrollSkip/5));b(".kads-slider-scroll-timeline",this.scrollframes).draggable({containment:"parent",drag:function(e,f){var d=b(this).draggable("option","snapTolerance");var g=f.position.left%1;if(g<=d){f.position.left=f.position.left-g}f.position.top=0;a.scrollMove(this.offsetLeft)}});var c=b(".kads-slider-layer-warp",this.g).offset().left;b(".kads-slider-layer-warp",this.g).mousemove(function(d){a.diLayer(this,d,c)});this.tlEvents()},tlEvents:function(){var d=b(".kads-slider-range-show",this.layerrows);var f=function(i){var h=i.offsetWidth,g=i.offsetLeft;a.addLayerData("wait",g);a.addLayerData("speed",(h*100));a.currentRangeValue.html((h-a.refixpx)*10);a.currentRangeDelay.css("width",(g+h-10))};b(".kads-slider-range-show,.kads-slider-range kads-slider-range-delay,.kads-slider-timeline-range",this.layerrows).mousedown(function(){var g=b(this).closest(".kads-slider-layer-item-timeline");if(b(this).attr("noat")!=="1"){var h=g.data("id");a.selectedbox(h)}});b(".kads-slider-layer-label",this.ll).mousedown(function(){var g=b(this).closest(".kads-slider-layer-item-label");var h=g.data("id");a.selectedbox(h)});d.draggable({containment:"parent",drag:function(h,i){var g=b(this).draggable("option","snapTolerance");var j=i.position.left%1;if(j<=g){i.position.left=i.position.left-j}i.position.top=0;f(this)}});d.resizable({handles:"e, w",resize:function(g,h){f(this)}});var c=0;var e=b(".kads-slider-ul-list-row").find("li").length-1;this.ll.sortable({start:function(g,h){c=h.helper.index()},change:function(i,j){var k=j.item.parent().find("li");var g="."+j.item.attr("class").split(" ")[0];var h=b(".kads-slider-ul-list-row");if(c>j.placeholder.index()){h.find("li").eq(k.index(j.placeholder)).before(h.find(g))}else{h.find("li").eq(k.index(j.placeholder)).after(h.find(g))}c=j.placeholder.index()},stop:function(i,j){var h=b(".kads-slider-ul-list-row");var g="."+j.item.attr("class").split(" ")[0];c=j.item.index();if(c===e){h.find("li").eq(c).after(h.find(g))}else{h.find("li").eq(c).before(h.find(g))}a.saveLayerItem()}});this.ltl.sortable();this.ll.disableSelection()},selectedbox:function(d){var c=b("#box-"+d,this.g);this.layerSelected=c;this.resetValue();this.isReset=1;b(".box-layer",this.g).removeClass("selected");c.addClass("selected");this.layerSelected=c;this.current=c.attr("current");this.currentData=this.getDataLayer(this.current);b.each(this.currentData,function(f,e){a.setctrlval(f,e)});this.clabel=b("#timelinelable-"+d,this.ll);this.ctline=b("#timeline-"+d,this.ltl);b(".kads-slider-layer-item-timeline",this.ltl).removeClass("selected");b(".kads-slider-layer-item-label",this.ll).removeClass("selected");this.ctline.addClass("selected");this.clabel.addClass("selected");this.currentRangeDelay=b(".kads-slider-range-delay",this.ctline);this.currentRangeValue=b(".kads-slider-range-value",this.ctline);this.isReset=0},copyLayer:function(h){var c=this.getListLayer(h);if(c){var g=this.getDataLayer(h);var f={};b.each(g,function(i,d){f[i]=d});var e=this.lidx;this.addLayer();b.each(f,function(i,d){a.styles.setval(a.layerSelected,i,d)});switch(f.type){case"html":case"image":break;case"button":break;default:this.setelmedia(f.link,f.type,"layer");break}this.currentData=f;this.setDataLayer(e,this.currentData);this.fnlayertldata(f);this.styles.setval(this.layerSelected,"top",0);this.styles.setval(this.layerSelected,"left",0);this.addLayerData("top",0);this.addLayerData("left",0)}},fnlayertldata:function(f){switch(f.type){case"html":if(this.currentData.html){var d=this.currentData.html.removehtml();b(".kads-slider-layer-labeltext",this.clabel).html(d)}break;case"image":b(".kads-slider-layer-labeltext",this.clabel).html("Image");b(".kads-slider-layer-icons",this.clabel).html('<span class="dashicons dashicons-format-image"></span>');break;case"button":b(".kads-slider-layer-labeltext",this.clabel).html("Button");b(".kads-slider-layer-icons",this.clabel).html('<span class="dashicons dashicons-share-alt"></span>');break;default:b(".kads-slider-layer-labeltext",this.clabel).html("Video");b(".kads-slider-layer-icons",this.clabel).html('<span class="dashicons dashicons-format-video"></span>');break}var c=f.speed/100;var e=f.wait+c;if(e>this.maxTimeRun){this.maxTimeRun=e-this.refixpx}b(".kads-slider-range-show",this.ctline).css({left:f.wait,width:c});b(".kads-slider-range-delay",this.ctline).css("width",(e-10));this.currentRangeValue.html((c-this.refixpx)*10)},saveLayerItem:function(){var c={};b(".kads-slider-layer-item-label",this.layerframes).each(function(){var f=b(this).data("id");var d=a.getLayerKey(f);var e=a.getDataLayer(f);c[d]=e});this.item.layers=c},loadScript:function(d,e){if(this.scriptLoaded[d]){if(e){e.call(this)}return}var c=this.sever.url+"/"+d;b.getScript(c,function(){a.scriptLoaded[d]=true;if(e){e.call(this)}})},loadcss:function(d){if(this.css3Loaded[d]){return}var c=this.sever.url+"/css/"+d;var e=b("<link>",{rel:"stylesheet",type:"text/css",href:c});e.appendTo("head");this.css3Loaded[d]=true},fnmPreview:function(){b("#actions-form",this.c).val("kads-slider-manager-preview");var c=b("#sliders_form",this.c).serializeArray();this.loadcss("preview-slider.css");b.ajax({url:this.sever.ajax,type:"post",data:c,success:function(d){if(d.success){b("#slider-preview-all-warper").html(d.data);b(".slider-preview-all-warper").fadeIn()}},error:function(d,f,e){}});b("#actions-form",this.c).val("save-slider")}};b.fn.kadsSliderChangeVal=function(c){return b(this).val(c).trigger("change")};b.fn.removeClassExcept=function(c){return this.each(function(){b(this).removeClass().addClass(c)})};b(document).ready(function(){b.kadsManager.init()})})(jQuery);